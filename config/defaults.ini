# Default configuration for Endless image builds

[buildroot]
# Directories to mount in the buildroot
mounts_add_default = /sys
                     /proc
                     /dev
                     /dev/pts
                     ${sysconfdir}
                     ${cachedir}
                     ${srcdir}

# Debian package repository setup for the buildroot
repo =  http://obs-master.endlessm-sf.com:82/shared/eos
arch = ${build:arch}
codename = ${branch}
components = core endless

# Script to use for debootstrap
script = ${datadir}/debootstrap.script

# Packages to install in the debootstrap buildroot
packages_add_default = attr
                       awscli
                       ca-certificates
                       coreutils
                       cpio
                       eos-keyring
                       flatpak
                       gir1.2-flatpak-1.0
                       gir1.2-glib-2.0
                       gir1.2-ostree-1.0
                       git
                       gnupg
                       mount
                       openssh-client
                       ostree
                       pigz
                       python
                       python3
                       python3-apt
                       python3-gi
                       rsync
                       udev
                       util-linux
                       unzip
                       wget
                       xz-utils

# Apt archive cache directory
aptcache_dir = ${contentdir}/archives

# Apt archive cache maximum size in bytes (default 2 GB)
aptcache_max_size = 2147483648

[check]
# Merged customization hooks to run.
hooks_add_default = 50-config
                    50-media
                    50-ostree-commit

[content]
# Merged customization hooks to run.
hooks_add_default = 50-codecs-extra
                    50-flatpak
                    50-media
                    50-gnome-software-cache

[image]
# Merged customization hooks to run.
hooks_add_default = 40-flatpak-setup.chroot
                    41-flatpak-upstream-repos.chroot
                    42-flatpak-upstream-content.chroot
                    45-flatpak-install.chroot
                    50-branding-background
                    50-branding-control-center
                    50-branding-desktop
                    50-branding-fbe
                    50-language
                    50-media
                    50-timezone
                    50-update-done-stamp
                    50-readahead
                    50-gnome-software-cache
                    50-eos-dir-mode-700
                    60-dconf-prepare
                    61-dconf-compile.chroot
                    63-icon-grid
                    70-flatpak-manifest
                    70-ostree-manifest
                    80-ldconfig-aux-cache.chroot

# Gzip compression by default (valid choices: gz or xz)
compression = gz

# Whether the root filesystem should be resized on first boot or not
rootfs_resize = true

# Don't create split images by default, as this is only used
# with specific Endless devices
split = false

# Split disk image sizes in bytes. By default, disk1 and disk2 are 16 GB
# (16 * 10**9, not 16 * 2**30). Single disk images are currently made to
# whatever size the content dictates.
disk1_size = 16000000000
disk2_size = 16000000000

# Create boot.zip by default
boot_zip = true

# Don't build ISOs by default
iso = false

# Don't reorder data by default
reorder = false

# GPG private key ID for signing images. If this is left blank, detached
# signatures will not be created.
signing_keyid = 587A279C

# Image uploading
host_short = images
host = ${host_short}.endlessm.com
user = uploader
path = /srv/images/www/nightly
destdir = ${path}/${product}-${arch}-${platform}/${branch}/${personality}/${build_version}

# Image downloading
url_root = http://${host}
url = ${url_root}/nightly/${product}-${arch}-${platform}/${branch}/${personality}/${build_version}

# Add sample media in /var/endless-content
sample_media_host = image-content.endlessm.com
sample_media_user = uploader
sample_media_path = content/sample-media/${arch}/${personality}

# Add preloaded content in /var/lib/kalite
# Disabled for now until we have permission to ship Khan Academy content
kalite_content = false
kalite_content_host = image-content.endlessm.com
kalite_content_user = uploader
kalite_content_path = content/kalite

# Product name for ISO labels, etc
product_name = Endless OS

# Default language (locale)
language =

# Default timezone
timezone =

# dconf overrides. Each of the elements of this list should be a keyfile in the
# format explained at https://wiki.gnome.org/Projects/dconf/SystemAdministrators
settings_add_default =

# dconf keys to lock
settings_locks_add_default =

# Hostname, to be used from the IMAGE hook 50-hostname.
# It might override values set by the OSTree builder.
hostname =

# URL for a remote KALite server (e.g., "http://teacher.local:8008")
# to be used from the IMAGE hook 50-virtualschool
kalite_server =

# Base URL to download chrome plugins from, to be used from the IMAGE hook
# 50-chrome-plugins-updater-url. It might override values set by the OSTree builder.
chrome_plugins_base_URL =

# Default partition table
partition_table = gpt

# Desktop icon grid overrides
icon_grid_add_defaults =

# Brand-specific configuration and assets for the Control Center
branding_control_center_config =
branding_control_center_logo =

# Brand-specific configuration and assets for the Desktop
branding_desktop_config =
branding_desktop_logo =

# Brand-specific configuration and assets for the First Boot Experience
branding_fbe_config =
branding_fbe_logo =

[split]
# Merged customization hooks to run.
# For now, omit the upstream content (gnome runtime) to fit on SD card.
hooks_add_default = 20-flatpak-prep-disk2
                    30-flatpak-clean-disk1.chroot
                    41-flatpak-upstream-repos.chroot
                    45-flatpak-install.chroot
                    50-eos-setup-flatpak-extension-dir-extra.chroot
                    70-flatpak-manifest

[ostree]
# Repository setup. By default the eos-${arch} repo and eos OS name are
# used.
product = ${build:product}
branch = os/${product}/${platform}/${build:branch}
repo = eos-${arch}
os = eos
remote = eos

# Multiple stable minor version branches may be in use, but the deployed
# ostree configuration should use only the major version. E.g., the real
# branch may be eos2.2, but the deployed configuration should use eos2.
branch_deploy = os/${product}/${platform}/${series}

# Builder directories
repodir = ${cachedir}/ostree/${repo}
checkout = ${build:tmpdir}/ostree-co

# The ostree URL that the final system will query for updates. Not used
# during build time.
url_root = https://ostree.endlessm.com
url_base = ${url_root}/ostree
url = ${url_base}/${repo}

# Development ostree repo URL root. The OS and apps are pulled from here
# during the build.
dev_url_root = https://endless:***REMOVED***@origin.ostree.endlessm.com/staging/dev

# Internal ostree server URL. This is used to pull the most recent
# commit.
int_url = ${dev_url_root}/${repo}

[manifest]
# Merged customization hooks to run.
hooks_add_default =

[publish]
# Merged customization hooks to run.
hooks_add_default = 30-start-publishing
                    40-build-log
                    50-publish
                    60-end-publishing
                    90-email-success

[error]
# Merged customization hooks to run.
hooks_add_default = 50-fail-publishing

[email]
# Success email settings
from = image-builder@endlessm.com
replyto = endless-dev@endlessm.com
to = endless-dev-status@endlessm.com

# SMTP settings
#   host - SMTP server hostname (default: localhost)
#   port - SMTP server port (default: 0, which means standard ports)
#   ssl  - Encrypt SMTP connection with SSL changing the default port
#          from 25 to 465 (default: false)
#   user - SMTP authentication user (default: not set)
#   pass - SMTP authentication password (default: not set)
host = localhost
port = 0
ssl = false
user =
pass =

[flatpak]
# Switch to allow disabling flatpak on some products
enable = true

# Locales to use when pulling runtimes
locales_add_default = ar bn en es fr id pt th vi zh
locales_del_default =

# Repository names on the sever
apps_repo = eos-apps
runtimes_repo = eos-${arch}
endless_apps_sdk_repo = eos-sdk

# Internal repos for pulling apps and runtimes
apps_server = ${ostree:dev_url_root}/${apps_repo}
runtimes_server = ${ostree:dev_url_root}/${runtimes_repo}
endless_apps_sdk_server = ${ostree:dev_url_root}/${endless_apps_sdk_repo}

# URL settings used for deployment. By default, same server as ostree.
url_root = ${ostree:url_root}
url_base = ${url_root}/ostree
apps_deploy_server = ${url_base}/${apps_repo}
runtimes_deploy_server = ${url_base}/${runtimes_repo}
endless_apps_sdk_deploy_server = ${url_base}/${endless_apps_sdk_repo}

# Remote names for the flatpak Endlessm apps and runtimes
apps_remote = eos-apps
runtimes_remote = eos-runtimes
endless_apps_sdk_remote = eos-sdk

# Branch to use for application bundles
apps_branch = ${series}

# Branch for the legacy runtime
runtime_branch = eos3.2

# Latest branch of Endless Apps SDK, will be installed in any case
endless_apps_sdk_branch = 1

# Platform runtime and architecture to install for the flatpak contents.
# The ${arch} name needs to be converted to the format which flatpak expects
# which are 'x86_64', 'arm', and 'i386' instead.
runtime = com.endlessm.Platform
runtime_arch=${deb_host_gnu_cpu}
endless_apps_sdk_runtime = com.endlessm.apps.Platform
endless_apps_sdk_runtime_arch = ${deb_host_gnu_cpu}

# SDK runtime, disabled by default
sdk = com.endlessm.Sdk
install_sdk = false
endless_apps_sdk_sdk = com.endlessm.apps.Sdk
install_endless_apps_sdk_sdk = false

# Which EknServices versions to install; these are required for providing
# runtime services to apps that integrate with the Endless desktop, so the
# EknServices versions corresponding with the installed apps should be
# installed on most or all images. The default value of "auto" should do this
# for the installed apps. If an image isn't installing apps, then you can
# specify a comma-separated list of versions to install (e.g. "1,2".)
install_ekn_services = auto

# Default flatpaks to install from Endless. This can be appended to by
# using any flatpaks key beginning with install_eos_add_. These will be
# merged together with the corresponding install_eos_del_ keys to a single
# install_eos key. All additions and removals can be overridden by providing
# a single install key.
install_eos_add_default = com.endlessm.finance
                          com.endlessm.photos
                          com.endlessm.programming
                          com.endlessm.resume
                          com.endlessm.translation
                          com.github.Slingshot
                          de.billardgl.Billardgl
                          io.github.Supertux
                          net.blockout.Blockout2
                          net.gcompris.Gcompris
                          net.minetest.Minetest
                          net.olofson.Kobodeluxe
                          net.sourceforge.Atanks
                          net.sourceforge.Audacity
                          net.sourceforge.Btanks
                          net.sourceforge.ChromiumBSU
                          net.sourceforge.Extremetuxracer
                          net.sourceforge.Rili
                          net.sourceforge.Supertuxkart
                          net.sourceforge.Torcs
                          net.sourceforge.Tuxfootball
                          net.sourceforge.Warmux
                          net.wz2100.Warzone2100
                          org.armagetronad.Armagetronad
                          org.debian.alioth.tux4kids.Tuxmath
                          org.debian.alioth.tux4kids.Tuxtype
                          org.debian.Tuxpuck
                          org.freeciv.Freeciv
                          org.frozenbubble.FrozenBubble
                          org.gimp.Gimp
                          org.gnome.Freecell
                          org.gnome.Genius
                          org.gnome.Gnote
                          org.gnome.Iagno
                          org.gnome.people.dscorgie.Labyrinth
                          org.gnome.Quadrapassel
                          org.gnome.Solitaire
                          org.gnome.Tetravex
                          org.inkscape.Inkscape
                          org.kde.Kalzium
                          org.kde.Kapman
                          org.kde.Katomic
                          org.kde.Kblocks
                          org.kde.Kbounce
                          org.kde.Kbruch
                          org.kde.Kdiamond
                          org.kde.Kgeography
                          org.kde.Kgoldrunner
                          org.kde.Khangman
                          org.kde.Kigo
                          org.kde.Killbots
                          org.kde.Kjumpingcube
                          org.kde.Klines
                          org.kde.Knavalbattle
                          org.kde.Knetwalk
                          org.kde.Ksame
                          org.kde.Ksquares
                          org.kde.Ksudoku
                          org.kde.Ktuberling
                          org.kde.Kubrick
                          org.kde.Kwordquiz
                          org.kde.Palapeli
                          org.maemo.Numptyphysics
                          org.marsshooter.Marsshooter
                          org.openarena.Openarena
                          org.openscad.Openscad
                          org.pitivi.Pitivi
                          org.seul.Pingus
                          org.squeakland.Etoys
                          org.squeakland.Scratch
                          org.stellarium.Stellarium
                          org.sugarlabs.Turtleblocks
                          org.tuxfamily.Xmoto
                          org.tuxpaint.Tuxpaint
                          org.wesnoth.Wesnoth

# Default flatpaks to skip. This can be appended to by using any flatpaks key
# beginning with install_del_.
install_eos_del_default =

# Same, but for runtime extensions. The values for this key are remote-name,
# extension ID, branch, separated by commas. Currently only extensions from
# already-added remotes are supported.
# For example: gnome,org.freedesktop.Platform.GL.Nvidia-123,1.6
install_extensions_add_default = eos-sdk,org.freedesktop.Platform.Icontheme.EndlessOS,1.0
install_extensions_del_default =

# Apps to be removed from split images. This can be appended to by using
# any apps key beginning with nosplit_add_. These will be merged
# together with the corresponding nosplit_del_ keys to a single nosplit
# key. All additions and removals can be overridden by providing a
# single nosplit key.
nosplit_add_default =

# Apps to skip removing from split images. This can be appended to by
# using any apps key beginning with nosplit_del_.
nosplit_del_default =

# Flathub repo configuration and remote name
flathub_repo = https://flathub.org/repo/flathub.flatpakrepo
flathub_remote = flathub

# Upstream GNOME repo configuration and remote name for pulling runtimes
gnome_runtimes_server = https://sdk.gnome.org/repo/
gnome_gpg = https://sdk.gnome.org/keys/gnome-sdk.gpg
gnome_runtimes_remote = gnome

# Default branches to to install from the GNOME upstream repository. These
# will be merged together with the corresponding gnome/freedesktop_branch_del_
# keys to a single install key. All additions and removals can be overridden
# by providing a single install key.
gnome_branch_add_default = 3.26
freedesktop_branch_add_default =
kde_branch_add_default =

# Default flatpaks to skip from the GNOME upstream repository.
gnome_branch_del_default =
freedesktop_branch_del_default =
kde_branch_del_default =

# Platform runtime and architecture to install for the flatpak contents.
# The ${arch} name needs to be converted to the format which flatpak expects
# which are 'x86_64', 'arm', and 'i386' instead.
gnome_runtime_platform = org.gnome.Platform
gnome_runtime_sdk = org.gnome.Sdk
freedesktop_runtime_platform = org.freedesktop.Platform
freedesktop_runtime_sdk = org.freedesktop.Sdk
kde_runtime_platform = org.kde.Platform
kde_runtime_sdk = org.kde.Sdk

# Whether we want to install GNOME SDK runtime.
install_gnome_sdk = false
install_freedesktop_sdk = false
install_kde_sdk = false

# Default flatpaks to install from Flathub. These will be merged
# together with the corresponding install_flathub_del_ keys
# to a single install key. All additions and removals can be overridden
# by providing a single install key.
install_flathub_add_default = com.teeworlds.Teeworlds
                              org.gnome.Weather
                              org.megaglest.MegaGlest

# Default flatpaks to skip from Flathub.
install_flathub_del_default =

# Optional extra flatpak repository for project-specific apps
# that can be enabled via the 43-flatpak-extra-apps.chroot hook.
# Machine-parsable name for the repo (e.g., my-project-apps)
extra_apps_remote =
# User-visible name for the repo (e.g., My Project Applications)
extra_apps_title =
# Staging server used to install apps onto the image
# (e.g., http://ostree.endlessm-sf.com/staging/dev/my-project-apps)
extra_apps_server =
# Production server used by the deployed system for app updates
# (e.g., ${url_base}/my-project-apps)
extra_apps_deploy_server =
# Default flatpaks to install from the extra repository. These
# will be merged together with the corresponding install_extra_del_ keys
# to a single install key. All additions and removals can be overridden
# by providing a single install key.
install_extra_add_default =
# Default flatpaks to skip from the extra repository
install_extra_del_default =
